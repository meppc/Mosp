import { Button, VerticalBox, HorizontalBox, LineEdit } from "std-widgets.slint";
import { CanvasView } from "../src/ui/canvas_view.slint";

// ä¸º Mosp åº”ç”¨ç¨‹åºåˆ›å»ºçš„ä¸»çª—å£ç»„ä»¶
export component MainWindow inherits Window {
    // æ¥æ”¶æœ¬åœ°åŒ–æ–‡æœ¬çš„å±æ€§
    in-out property <string> app_title: "å¢¨å¸";
    in-out property <string> canvas_placeholder: "ç”»å¸ƒå°†åœ¨æ­¤å¤„å®ç°";
    in-out property <string> properties: "å±æ€§";
    in-out property <string> tool_properties: "å·¥å…·å±æ€§å°†åœ¨æ­¤å¤„æ˜¾ç¤º";
    in-out property <string> brush_tool: "ç”»ç¬”";
    in-out property <string> shape_tool: "å½¢çŠ¶";
    in-out property <string> arrow_tool: "ç®­å¤´";
    in-out property <string> eraser_tool: "æ©¡çš®æ“¦";
    in-out property <string> text_tool: "æ–‡æœ¬";
    in-out property <string> selection_tool: "é€‰æ‹©";
    
    title: app_title;
    min-width: 800px;
    min-height: 600px;
    
    // Tool state
    property <int> toolType: 0; // 0: Brush, 1: Shape, 2: Arrow, 3: Eraser, 4: Text, 5: Selection
    
    // Callbacks
    callback exit();
    callback show_error(string);
    callback show_info(string);
    
    Rectangle {
        background: #f5f5f5;
        vertical-stretch: 1;
        
        HorizontalBox {
            padding: 8px;
            spacing: 8px;
            
            // Toolbar
            VerticalBox {
                width: 40px;
                spacing: 8px;
                
                // Brush tool
                Rectangle {
                    height: 40px;
                    border-radius: 4px;
                    background: toolType == 0 ? #e0e0e0 : transparent;
                    border-width: 1px;
                    border-color: #ccc;
                    
                    Text {
                        text: "ğŸ–Œï¸";
                        font-size: 20px;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                    
                    TouchArea {
                        clicked => {
                            toolType = 0;
                        }
                    }
                }
                
                // Shape tool
                Rectangle {
                    height: 40px;
                    border-radius: 4px;
                    background: toolType == 1 ? #e0e0e0 : transparent;
                    border-width: 1px;
                    border-color: #ccc;
                    
                    Text {
                        text: "â¬œ";
                        font-size: 20px;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                    
                    TouchArea {
                        clicked => {
                            toolType = 1;
                        }
                    }
                }
                
                // Arrow tool
                Rectangle {
                    height: 40px;
                    border-radius: 4px;
                    background: toolType == 2 ? #e0e0e0 : transparent;
                    border-width: 1px;
                    border-color: #ccc;
                    
                    Text {
                        text: "â¡ï¸";
                        font-size: 20px;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                    
                    TouchArea {
                        clicked => {
                            toolType = 2;
                        }
                    }
                }
                
                // Eraser tool
                Rectangle {
                    height: 40px;
                    border-radius: 4px;
                    background: toolType == 3 ? #e0e0e0 : transparent;
                    border-width: 1px;
                    border-color: #ccc;
                    
                    Text {
                        text: "ğŸ§½";
                        font-size: 20px;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                    
                    TouchArea {
                        clicked => {
                            toolType = 3;
                        }
                    }
                }
                
                // Text tool
                Rectangle {
                    height: 40px;
                    border-radius: 4px;
                    background: toolType == 4 ? #e0e0e0 : transparent;
                    border-width: 1px;
                    border-color: #ccc;
                    
                    Text {
                        text: "T";
                        font-size: 20px;
                        font-weight: 700;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                    
                    TouchArea {
                        clicked => {
                            toolType = 4;
                        }
                    }
                }
                
                // Selection tool
                Rectangle {
                    height: 40px;
                    border-radius: 4px;
                    background: toolType == 5 ? #e0e0e0 : transparent;
                    border-width: 1px;
                    border-color: #ccc;
                    
                    Text {
                        text: "â—»ï¸";
                        font-size: 20px;
                        horizontal-alignment: center;
                        vertical-alignment: center;
                    }
                    
                    TouchArea {
                        clicked => {
                            toolType = 5;
                        }
                    }
                }
                
                Rectangle { vertical-stretch: 1; }
            }
            
            // Canvas area
            CanvasView {
                horizontal-stretch: 1;
                
                draw-start(point) => {
                    // å®ç°å·¥å…·å¯¹åº”çš„ç»˜åˆ¶å¼€å§‹é€»è¾‘
                }
                
                draw-move(point) => {
                    // å®ç°å·¥å…·å¯¹åº”çš„ç»˜åˆ¶ç§»åŠ¨é€»è¾‘
                }
                
                draw-end(point) => {
                    // å®ç°å·¥å…·å¯¹åº”çš„ç»˜åˆ¶ç»“æŸé€»è¾‘
                }
            }
            
            // Properties panel
            VerticalBox {
                width: 200px;
                padding: 8px;
                spacing: 8px;
                
                Text {
                    text: properties;
                    font-weight: 700;
                }
                
                Rectangle {
                    height: 1px;
                    background: #ccc;
                }
                
                // Tool-specific properties will be shown here
                // This is a placeholder
                Text {
                    text: tool_properties;
                    font-size: 12px;
                    wrap: word-wrap;
                }
                
                Rectangle { vertical-stretch: 1; }
            }
        }
    }
}
